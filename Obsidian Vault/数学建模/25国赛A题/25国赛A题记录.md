
# 一、坐标系与符号

* 建立题面坐标系：以“假目标”为原点 $O=(0,0,0)$，水平面为 $xy$ 平面；真目标为半径 $7\ \text{m}$、高 $10\ \text{m}$ 的圆柱体，其下底面圆心在 $(0,200,0)$，故几何中心在
  $$
  \mathbf T_c=(0,200,5).
  $$
  （如需严格遮蔽整个圆柱，可把 $\mathbf T_c$ 换成目标表面上若干代表点的集合，见第「三」节扩展。）

* 常量：导弹恒速 $v_m=300\ \text{m/s}$（直指原点做直线匀速飞行）；重力加速度 $g=9.8\ \text{m/s}^2$；烟幕球有效半径 $R=10\ \text{m}$，起爆后云团中心以 $v_s=3\ \text{m/s}$ 匀速下沉且仅在起爆后 $20\ \text{s}$ 内有效。

# 二、三类运动学方程

## 1) 导弹 $k$ 的轨迹

设导弹 $k$ 的初始位置为 $\mathbf M_{k0}$，其飞行方向直指原点，单位方向向量

$$
\hat{\mathbf u}_k=\frac{\mathbf 0-\mathbf M_{k0}}{\|\mathbf M_{k0}\|}.
$$

则导弹位置

$$
\boxed{\ \mathbf M_k(t)=\mathbf M_{k0}+v_m t\,\hat{\mathbf u}_k\ }\qquad (t\ge0). \tag{1}
$$

（题面给出 $M_1=(20000,0,2000)$、$M_2=(19000,600,2100)$、$M_3=(18000,-600,1900)$。）

## 2) 无人机 $j$ 的轨迹与投放

无人机初始位置 $\mathbf F_{j0}$；其飞行等高度、匀速直线，速度 $v_j\in[70,140]$（m/s），水平单位航向 $\hat{\mathbf q}_j=(\cos\psi_j,\sin\psi_j,0)$：

$$
\boxed{\ \mathbf F_j(t)=\mathbf F_{j0}+v_j t\,\hat{\mathbf q}_j\ }\qquad (t\ge0). \tag{2}
$$

第 $i$ 枚干扰弹从无人机 $j$ 在时刻 $t_{j,i}^{\rm drop}$ 投放，投放瞬时速度即无人机速度 $\mathbf v_{j} = v_j\hat{\mathbf q}_j$（仅水平分量），引信延时 $\tau_{j,i}>0$，起爆时刻

$$
t_{j,i}^{\rm exp}=t_{j,i}^{\rm drop}+\tau_{j,i}. \tag{3}
$$

## 3) 干扰弹的弹道与云团轨迹

忽略空气阻力，投放后在重力作用下运动，投放点 $\mathbf D_{j,i}=\mathbf F_j(t_{j,i}^{\rm drop})$。则起爆点

$$
\boxed{\ \mathbf C_{j,i}=\mathbf D_{j,i}+\mathbf v_{j}\,\tau_{j,i}+\frac12(0,0,-g)\,\tau_{j,i}^{\,2}\ }. \tag{4}
$$

起爆后云团中心沿竖直方向下沉：

$$
\boxed{\ \mathbf C_{j,i}(t)=\mathbf C_{j,i}+(0,0,-v_s)\,(t-t_{j,i}^{\rm exp}),\quad t\in[t_{j,i}^{\rm exp},\,t_{j,i}^{\rm exp}+20]\ }. \tag{5}
$$

（题面规定 $v_s=3\ \text{m/s}$、有效 20 s。）

# 三、遮蔽判据（单枚云团对单枚导弹）

给定某一目标代表点 $\mathbf P$（常用 $\mathbf T_c$），当且仅当“导弹—目标”的视线段与半径 $R$ 的球（云团）相交且云团在导弹与目标之间，视为“被遮蔽”。

设时间 $t$ 时刻导弹在 $\mathbf M(t)$，云团中心在 $\mathbf C(t)$，定义

$$
\mathbf A(t)=\mathbf P-\mathbf M(t),\qquad \mathbf B(t)=\mathbf C(t)-\mathbf M(t).
$$

云团中心在视线段 $[\mathbf M(t),\mathbf P]$ 的投影参数

$$
u^*(t)=\frac{\mathbf B(t)\cdot \mathbf A(t)}{\|\mathbf A(t)\|^2}.
$$

到视线的最小距离

$$
d_\perp^2(t)=\|\mathbf B(t)\|^2-\frac{\big(\mathbf B(t)\cdot \mathbf A(t)\big)^2}{\|\mathbf A(t)\|^2}.
$$

**遮蔽充要条件（判据）**

$$
\boxed{\ 0\le u^*(t)\le 1\ \ \text{且}\ \ d_\perp(t)\le R\ }. \tag{6}
$$

注：若你要“严格遮蔽整个圆柱目标”，可把 $\mathbf P$ 取为目标表面上一组离散代表点（如高度 $z\in\{0,5,10\}$ 与圆周若干方位角），令这些点均满足(6)。这样会比只取中心点更保守一些。

# 四、有效遮蔽时间的定义（集合表示更清晰）

对某枚云团 $(j,i)$ 与某枚导弹 $k$，其“有效遮蔽时间集合”

$$
\mathcal S_{j,i}^{(k)}=\Big\{t\in[t_{j,i}^{\rm exp},\,t_{j,i}^{\rm exp}+20]\ \Big|\ \text{式}(6)\ \text{成立}\Big\}. \tag{7}
$$

对该导弹的总遮蔽集合是所有云团的并集

$$
\boxed{\ \mathcal S^{(k)}=\bigcup_{j,i}\mathcal S_{j,i}^{(k)}\ },\quad \text{总遮蔽时长 } \ \boxed{\,\mathcal T^{(k)}=\mu\big(\mathcal S^{(k)}\big)\,}. \tag{8}
$$

若场景中有多枚导弹（如 $M_1,M_2,M_3$），为了“尽量避免来袭导弹发现真目标”，一个自然且保守的目标是 **同时遮蔽**：

$$
\boxed{\ \mathcal S^{\rm all}=\bigcap_k \mathcal S^{(k)},\qquad \mathcal T^{\rm all}=\mu\big(\mathcal S^{\rm all}\big)\ }. \tag{9}
$$

（当然，也可用权重求和 $\sum_k w_k\mathcal T^{(k)}$ 作为次优目标。）

# 五、问题1：代入题面给定策略，给出**数值**有效遮蔽时长

题面：仅用 FY1 干扰 $M_1$。FY1 以 $120\,\text{m/s}$ 朝向假目标飞行，受领任务 $1.5\,\text{s}$ 后投放一枚，**间隔 $3.6\,\text{s}$ 后起爆**（即引信延时 $\tau=3.6\ \text{s}$）。FY1 等高度飞行，高度保持 $z=1800\ \text{m}$。初始：$M_1=(20000,0,2000)$，FY1=$(17800,0,1800)$。

1. **FY1 的航迹（朝原点的水平航向）**

$$
\hat{\mathbf q}=\frac{(0,0,0)-(17800,0,0)}{\|(0,0,0)-(17800,0,0)\|}=(-1,0,0),\quad v=120.
$$

投放时刻 $t_{\rm drop}=1.5$ s 的投放点

$$
\mathbf D=(17800,0,1800)+120\cdot1.5\,(-1,0,0)=(17620,0,1800). \tag{10}
$$

2. **起爆点（弹道计算）**（式(4)）

$$
\mathbf C=\mathbf D+\underbrace{120(-1,0,0)}_{\mathbf v}\cdot 3.6+\tfrac12(0,0,-g)\cdot(3.6)^2
=(17188,\,0,\,1736.496). \tag{11}
$$

起爆时刻 $t_e=1.5+3.6=5.1\ \text{s}$。

3. **起爆后云团中心**（式(5)）

$$
\mathbf C(t)=\big(17188,\,0,\,1736.496\big)+(0,0,-3)\,(t-5.1),\quad t\in[5.1,\,25.1]. \tag{12}
$$

4. **导弹 $M_1$ 轨迹**（式(1)）

$$
\hat{\mathbf u}=\frac{(0,0,0)-(20000,0,2000)}{\sqrt{20000^2+2000^2}}
=\Big(-\frac{20000}{\sqrt{404}\,10^3},\,0,\,-\frac{2000}{\sqrt{404}\,10^3}\Big),
$$

$$
\mathbf M(t)=(20000,0,2000)+300t\,\hat{\mathbf u}. \tag{13}
$$

5. **遮蔽判据**（式(6) with $\mathbf P=\mathbf T_c=(0,200,5)$）
   将(12)(13)代入(6)，可在区间 $[5.1,25.1]$ 内求出满足条件的时间集合 $\mathcal S^{(M_1)}$。数值计算结果：

$$
\boxed{\ \mathcal S^{(M_1)}\approx[8.014\ \text{s},\ 9.419\ \text{s}]\ ,\quad \mathcal T^{(M_1)}\approx 1.405\ \text{s}\ }.
$$

——这就是题问“有效遮蔽时长”。

> 说明
>
> * 我采用目标几何中心 $\mathbf T_c$ 作为代表点。若改用“目标表面的多点判据”，可按第「三」节的方法把 $\mathbf P$ 设为多个点并取交集，会得到**略短**的时长（更保守）。
> * 上述数值完全由题面给定策略导出，无需任何调参。
![[25国赛A题记录.assets/file-20250904220139020.png]]

注意：这里由于尺度问题（真目标自身的大小与M1 FY1的距离相比极小），因此基本可以不考虑是否能遮住的问题

# 六、问题2：最优“单弹—单导弹”策略的数学规划

**决策变量**（以 FY1 干扰 $M_1$ 为例）

$$
\psi\ (\text{航向角}),\quad v\in[70,140],\quad t_{\rm drop},\ \tau\ (>0).
$$

由(2)–(5)得到 $\mathbf C(t)$；由(1)得到 $\mathbf M_1(t)$。

**目标函数**

$$
\max_{\psi,v,t_{\rm drop},\tau}\ \ \mathcal T^{(M_1)}=\mu\!\left(\big\{t\in[t_e,t_e+20]:\ 0\le u^*(t)\le 1,\ d_\perp(t)\le R\big\}\right),
$$

其中 $t_e=t_{\rm drop}+\tau$，$u^*,d_\perp$ 用(6) 计算。

**约束**
无人机等高直线：已体现在(2)；速度范围 $v\in[70,140]$；投放时刻 $t_{\rm drop}\ge0$；起爆时刻 $t_e\ge t_{\rm drop}$。若题目给“受领后最早投放/起爆”的规则，也可直接加上线性不等式。

> 解法建议：离散化时间轴（例如 0.01–0.05 s 网格），把目标改为“计数满足(6) 的网格点个数”。这样可用网格搜索、粒子群、模拟退火等黑箱优化器求近似最优解；也可对 $(\psi,v)$ 做粗网格，对 $(t_{\rm drop},\tau)$ 做细网格，效率更高。

# 七、问题3：FY1 投放 3 枚的“并集遮蔽”优化

令 $i=1,2,3$ 表示三枚弹，决策 $\{t_{{\rm drop},i},\tau_i\}$；同一无人机的投放间隔约束

$$
t_{{\rm drop},i+1}-t_{{\rm drop},i}\ \ge\ 1\ \text{s}. \tag{14}
$$

每枚弹给出各自的 $\mathbf C_i(t)$（式(4)(5)），对同一导弹 $M_1$ 的总遮蔽集合为

$$
\mathcal S^{(M_1)}=\bigcup_{i=1}^3 \mathcal S_{i}^{(M_1)},\qquad 
\max\ \mu\big(\mathcal S^{(M_1)}\big). \tag{15}
$$

输出到 `result1.xlsx` 时，逐枚列出 $(\psi,v,t_{{\rm drop},i},\tau_i,\mathbf C_i)$ 与对应的遮蔽区间 $[t_{\min,i},t_{\max,i}]$。


# 八、问题4：FY1、FY2、FY3 各投 1 枚、共同干扰 $M_1$

设三架无人机的决策分别为 $(\psi_j,v_j,t_{{\rm drop},j},\tau_j)$（$j=1,2,3$），总遮蔽集合

$$
\mathcal S^{(M_1)}=\bigcup_{j=1}^3 \mathcal S_{j}^{(M_1)},\quad 
\max\ \mu\big(\mathcal S^{(M_1)}\big). \tag{16}
$$

约束与(2)–(5) 相同，初始位置用题面 FY1–FY3 给定值。

# 九、问题5：5 架无人机、至多各投 3 枚，干扰 $M_1,M_2,M_3$

设集合 $\mathcal I$ 为所有“云团—导弹”的遮蔽集合：

$$
\mathcal S^{(k)}=\bigcup_{(j,i)} \mathcal S_{j,i}^{(k)}\quad (k=1,2,3),
\qquad 
\text{并取}\quad \mathcal S^{\rm all}=\bigcap_{k=1}^3 \mathcal S^{(k)}. \tag{17}
$$

**两种目标函数**（可二择一，论文里说明即可）：

* 保守型（同时遮蔽）：$\max \ \mu\big(\mathcal S^{\rm all}\big)$。
* 加权覆盖型：$\max \ \sum_{k=1}^3 w_k\,\mu\big(\mathcal S^{(k)}\big)$（$w_k$ 为威胁权重）。

**约束**

* 每架无人机 $j$：$v_j\in[70,140]$、等高直线；最多 3 枚：$i=1,2,3$。
* 同架间隔：$t_{{\rm drop},j,i+1}-t_{{\rm drop},j,i}\ge1\ \text{s}$。
* 其他均同(2)–(5)。
  把最终各弹的 $\{\psi_j,v_j,t_{{\rm drop},j,i},\tau_{j,i},\mathbf C_{j,i}\}$ 与各导弹的遮蔽区间写入 `result3.xlsx`。

---

## 小结（可直接复用到正文“模型与算法”部分）

1. 运动学：导弹(1)、无人机(2)、干扰弹起爆点(4)、云团(5)。
2. 遮蔽判据：投影参数 $u^*$ 与垂距 $d_\perp$ 的双条件 (6)。
3. 目标函数：并集/交集的**测度最大化** (8)(9)(15)(16)(17)。
4. 约束：速度范围与投放间隔等 (14)。
5. 数值示范（问题1）：按题面固定策略，FY1 对 $M_1$ 的有效遮蔽时长约 **1.405 s**，发生在 **8.014–9.419 s**。

如果你希望，我也可以把问题 3–5 的优化做成脚本，自动搜索出一套可复现实验的最优（或近优）投放参数，并生成 `result1/2/3.xlsx`。



第三题差分进化算法：
# 问题3的解法思路

问题3要求利用单架无人机FY1投放3枚烟幕干扰弹，对导弹M1实施干扰，目标是最大化总有效遮蔽时长（遮蔽可不连续，即取3枚云团遮蔽时间的并集）。输出包括无人机的飞行方向（航向角ψ）、速度v、每枚弹的投放点、起爆点等，并保存到result1.xlsx（基于附件模板，假设模板有列如：无人机ID、航向、速度、投放时间、引信延时、投放点坐标、起爆点坐标、遮蔽起始时间、遮蔽结束时间等）。

这是一个多变量优化问题，维度较高（约8维），但可通过数值方法高效求解。以下是推荐的解法框架，结合数学建模和计算工具实现。核心是使用全局优化算法求近似最优策略，因为目标函数（遮蔽时长）是非光滑的（依赖于时间区间的并集测量），不适合梯度方法。

#### 1. **问题形式化（基于解题思路）**
   - **决策变量**：
     - 无人机：航向角ψ ∈ [0, 2π]（弧度），速度v ∈ [70, 140] m/s。
     - 每枚弹i=1,2,3：投放时间t_drop,i ≥ 0，引信延时τ_i > 0。
     - 约束：t_drop,i+1 - t_drop,i ≥ 1 s（投放间隔）；假设t_drop,1 < t_drop,2 < t_drop,3。为避免优化中违反顺序，可参数化为：t_drop,1 ≥ 0，Δt_2 ≥ 1，Δt_3 ≥ 1，然后t_drop,2 = t_drop,1 + Δt_2，t_drop,3 = t_drop,2 + Δt_3。
     - 变量向量x = [ψ, v, t_drop,1, τ_1, Δt_2, τ_2, Δt_3, τ_3]（8维）。
   - **目标函数**：max T = μ(∪_{i=1}^3 S_i^{(M1)})，其中S_i^{(M1)}是第i枚云团对M1的遮蔽时间集合（见思路(7)）。
     - 计算T：数值方式（见下文），返回负值以转为最小化问题（f(x) = -T(x)）。
   - **约束**：仅界限约束（bounds），如t_drop,1 ∈ [0, 100]（合理上界，导弹飞行~67s），τ_i ∈ [0.1, 50]（避免过长下落），Δt_i ∈ [1, 100]。
   - **物理模型**：直接用思路中的方程(1)-(5)计算导弹轨迹M(t)、无人机轨迹F(t)、投放点D_i、起爆点C_i、云团轨迹C_i(t)。遮蔽判据用(6)，目标点P = T_c = (0,200,5)（若需更保守，可扩展到目标表面多点取交集，但增加计算量）。

#### 2. **计算遮蔽时长T的数值方法**
   - **离散化时间**：创建一个全局时间网格t_grid = np.linspace(0, 200, 4000)（dt≈0.05s，覆盖导弹飞行期~67s，计算开销可控）。
   - **对于每个云团i**：
     - 计算t_exp,i = t_drop,i + τ_i。
     - 对于t_grid中t ∈ [t_exp,i, t_exp,i + 20]的子集，计算M(t)、C_i(t)、A(t)=P - M(t)、B(t)=C_i(t) - M(t)。
     - u* = (B · A) / ||A||²，d_perp = sqrt(||B||² - (B · A)² / ||A||²)。
     - 如果0 ≤ u* ≤ 1且d_perp ≤ 10，则该t被第i枚云团遮蔽。
   - **并集覆盖**：创建一个布尔数组covered[t_grid]（初始False），对3枚云团逐一OR操作（如果任何云团遮蔽，则True）。
   - **时长T**：np.sum(covered) * dt（简单计数）。
   - **优化**：若想更精确，可用二分法求每个云团的遮蔽区间边界（[t_start,i, t_end,i]），然后用interval merging算法计算并集总长（避免网格误差）。但网格法已足够（误差<0.1s）。

#### 3. **优化算法推荐**
   - **首选：差分进化（Differential Evolution, DE）**  
     理由：全局优化、无需梯度、适合8维连续空间、鲁棒性强。Python环境中scipy.optimize.differential_evolution可用。
     - 参数：popsize=15（种群大小），maxiter=200（迭代），tol=0.01（收敛阈值）。运行时间~分钟级（每评估f(x)需~0.1s，总~6000评估）。
     - 代码框架（用code_execution工具运行）：
       ```python
       import numpy as np
       from scipy.optimize import differential_evolution

       # 常量
       g = 9.8
       vs = 3.0
       R = 10.0
       vm = 300.0
       Tc = np.array([0, 200, 5])
       M0 = np.array([20000, 0, 2000])
       norm_M0 = np.linalg.norm(M0)
       u = -M0 / norm_M0  # 导弹方向
       FY0 = np.array([17800, 0, 1800])

       # 导弹位置函数
       def M(t):
           return M0 + vm * t * u

       # 云团中心函数
       def C_func(C0, t_exp, t):
           return C0 + np.array([0, 0, -vs * (t - t_exp)])

       # 遮蔽检查
       def is_shielded(M_t, C_t, Tc):
           A = Tc - M_t
           B = C_t - M_t
           A_norm2 = np.dot(A, A)
           if A_norm2 == 0: return False
           u_star = np.dot(B, A) / A_norm2
           d2 = np.dot(B, B) - (np.dot(B, A)**2 / A_norm2)
           return (0 <= u_star <= 1) and (d2 <= R**2)  # 用d2避免sqrt

       # 目标函数f(x) = -T
       def objective(x):
           psi, v, tdrop1, tau1, dt2, tau2, dt3, tau3 = x
           tdrop2 = tdrop1 + dt2
           tdrop3 = tdrop2 + dt3
           t_drops = [tdrop1, tdrop2, tdrop3]
           taus = [tau1, tau2, tau3]
           
           # 计算3枚云团的C0和t_exp
           Cs = []
           t_exps = []
           q = np.array([np.cos(psi), np.sin(psi), 0])
           v_vec = v * q
           for i in range(3):
               D = FY0 + v_vec * t_drops[i]
               C = D + v_vec * taus[i] + 0.5 * np.array([0, 0, -g]) * taus[i]**2
               Cs.append(C)
               t_exps.append(t_drops[i] + taus[i])
           
           # 时间网格
           dt = 0.05
           t_grid = np.arange(0, 200, dt)
           covered = np.zeros(len(t_grid), dtype=bool)
           
           for i in range(3):
               t_exp = t_exps[i]
               C0 = Cs[i]
               mask = (t_grid >= t_exp) & (t_grid <= t_exp + 20)
               for j in np.where(mask)[0]:
                   t = t_grid[j]
                   M_t = M(t)
                   C_t = C_func(C0, t_exp, t)
                   if is_shielded(M_t, C_t, Tc):
                       covered[j] = True
           
           T = np.sum(covered) * dt
           return -T  # 最小化-T

       # 界限
       bounds = [(0, 2*np.pi), (70, 140), (0, 100), (0.1, 50), (1, 100), (0.1, 50), (1, 100), (0.1, 50)]

       # 运行优化
       result = differential_evolution(objective, bounds, popsize=15, maxiter=200, tol=0.01)
       print(result.x)  # 最优x
       print(-result.fun)  # 最优T
       ```
     - **改进**：若计算慢，可并行检查（用np.vectorize），或减小网格密度（dt=0.1s）。多次运行DE以避局部最优。

   - **备选1：粒子群优化（PSO）**  
     若DE收敛慢，用scipy没内置PSO，但可手动实现简单PSO（~50行代码，初始化粒子、更新速度/位置）。或用网格搜索粗优+DE细化。

   - **备选2：启发式+网格搜索**  
     - 固定ψ和v（粗网格，如ψ每π/10，v每10m/s），对{t_drop,i, τ_i}细网格搜索（间隔1s）。
     - 启发：ψ选择接近导弹轨迹（~朝向原点，ψ≈π），v~120（中值）。先解单弹最优（问题2），然后扩展到3弹（第二、三弹在第一弹后~10-20s投放，覆盖后期）。

#### 4. **输出处理**
   - 优化后，用最优x计算D_i、C_i（投放/起爆点）、每个云团的遮蔽区间（从covered中提取连续True段的start/end）。
   - 用pandas创建DataFrame，列匹配模板（e.g., '无人机':'FY1', '航向(度)':np.degrees(ψ), '速度(m/s)':v, '投放时间(s)':t_drop,i, '引信延时(s)':τ_i, '投放点x,y,z':D_i, '起爆点x,y,z':C_i, '遮蔽起始(s)':min_t_i, '遮蔽结束(s)':max_t_i）。
   - 保存：df.to_excel('result1.xlsx', index=False)（若环境支持）。

#### 5. **潜在挑战与优化**
   - **计算效率**：单次f(x)评估~0.1-0.5s（4000点×3云团），总优化~10-30min。可减t_grid到2000点，或只在[t_min_exp, t_max_exp+20]计算。
   - **多点判据**：若用目标表面多点（e.g., 8点：z=0/5/10，方位0/π），修改is_shielded为all(points satisfy)，T更保守。
   - **验证**：优化后，手动计算问题1策略的T（~1.405s），确保代码正确。画图（matplotlib）可视化轨迹/遮蔽区间。
   - **敏感性**：跑多次优化，选最佳T（>10s可能？单弹~几s，3弹可覆盖~15-20s）。
   - **扩展**：若需严格全局最优，可用更多迭代或混合算法（DE+Nelder-Mead局部细化）。

这个解法结合建模+数值优化，可靠且可实现。若需代码细节或模拟结果，我可以进一步细化。



\subsubsection{问题一} 问题一针对单枚导弹 M1 的干扰场景，在投放参数与延时参数均已给定的条件下，需依据导弹、无人机及干扰弹的运动学方程，结合遮蔽判据，即烟幕云团与 “导弹 — 真目标” 视线的相交条件，定量计算真目标被有效遮蔽的持续时长。 该问题的核心在于：构建导弹、无人机、干扰弹及烟幕云团的轨迹数学模型；推导遮蔽判据的解析表达式，包括云团中心在 “导弹 — 目标” 视线上的投影参数\(u^*\)与云团中心到该视线的垂直距离\(d_\perp\)；在有效时间区间内求解满足遮蔽判据的时刻集合，并计算该集合的时间测度，即总遮蔽时长。问题一作为整个研究的模型基础，所建立的遮蔽判据与时长计算方法，为后续各类干扰策略优化问题提供了关键的理论依据与数值计算框架。 \subsubsection{问题二} 问题二在问题一的基础上放宽了约束条件：无人机的航向角、飞行速度、投放时刻与引信延时均可作为可调参数。在这种情况下，需要建立一个“单枚干扰弹—单枚导弹”的遮蔽优化模型，以最大化真目标的有效遮蔽时长为优化目标。 该问题的核心在于：在保持无人机等高直线飞行约束的前提下，将航向角、飞行速度、投放时刻和延时作为决策变量，构建目标函数为遮蔽时长的非线性优化模型；利用遮蔽判据，即云团与“导弹—目标”视线的相交条件，判断在给定参数下的遮蔽区间；通过数值搜索或启发式算法求解最优参数组合，从而获得最大遮蔽时长。问题二由单纯的遮蔽时长计算转向投放策略的优化，为后续多弹、多无人机的协同优化问题奠定了方法论基础。 \subsubsection{问题三} 在问题二的基础上，问题三考虑同一无人机 FY1 依次投放三枚干扰弹，以最大化对同一导弹 $M_1$ 的总遮蔽时长。相比于问题二，问题三需要增加同一无人机的投放间隔约束，即每两发导弹发射时间需要间隔一秒。使用第二问的解法可以分别计算三枚弹对导弹 $M_1$ 的遮蔽时间集合，对这些遮蔽时间集合取并集,即可求得总遮蔽时长。 对于本问，需要求的变量达到8个，可采用粒子群算法（PSO）等启发式算法进行求解以达到更好的效果。 \subsubsection{问题四} 在问题二的基础上，问题四考虑三架无人机 FY1、FY2、FY3 分别各投放一枚干扰弹以遮蔽同一导弹 $M_1$。由于三机彼此距离较远，投弹后形成的遮蔽时间段在时间轴上可能基本错开，因此可将联合优化近似分解为三个相互独立的单机问题：分别按第二问的方法独立计算每架无人机的最优投放策略与对应的遮蔽时长；在重叠可以忽略的情况下，三者遮蔽时长相加即可得到总遮蔽时长。
\subsubsection{问题五} 本问场景下，防御方可调配最多五架无人机，每架最多投放三枚干扰弹，需协同干扰三枚来袭导弹 $M_1, M_2, M_3$。与前述问题相比，干扰弹与无人机数量显著增加，导弹目标也由单一扩展为多枚，整体优化的计算复杂度进一步提升。 由于三枚导弹同时来袭，最佳干扰策略应使每枚导弹的遮蔽时间都尽可能长，避免出现某枚导弹遮蔽时间过短而导致防御失效。因此，目标函数设置为三枚导弹的遮蔽时长之和，并在优化过程中兼顾各导弹遮蔽时间的均衡性。具体而言，先分别计算每枚导弹的总遮蔽时长，将三者之和作为优化目标，同时关注遮蔽时长的分布，避免出现极端不均衡。 在空间分布上，五架无人机通常可分为三组，分别主要负责干扰某一导弹，部分无人机可跨组协同。借鉴问题四的分解思路，先对每架无人机分别设计针对三枚导弹的投放策略，初步优化后再根据结果进行调整和协调，以提升整体遮蔽效果。 由于本问变量数量和组合方式大幅增加，直接全局优化的计算量极大。为此，需进一步改进启发式算法（如多次粒子群、分组协同搜索等），结合前述多项式—区间分析的高效评估器，分步优化各无人机—导弹组合，并在后处理阶段对遮蔽区间进行合并与均衡性修正。通过分组优化与启发式调整，能够在可接受的计算时间内获得较优的整体遮蔽方案，实现多导弹协同干扰的目标。

六、差分进化（DE）实现

DifferentialEvolution:
generate_valid_individual：随机生成并修复约束（确保时间序列与起爆时刻上界），多次失败则采用保守初始化策略。
变异 mutation（rand/1）、交叉 crossover（二进制交叉，保证至少一维来自变异向量）、选择 selection（最大化）。
optimize：初始化种群与适应度，循环执行变异-交叉-选择，记录 best 与平均适应度，支持收敛曲线绘制。
七、带反向学习的差分进化（OBL-DE）

DifferentialEvolutionWithOpposition:
初始化反向学习：对初始种群生成对立个体 x' = lb + ub - x，评估 2N 个体，择优取 N 个作初始。
演化中周期性触发反向学习（opposition_interval，概率 opposition_rate），再次生成反向种群与当前合并择优，以增强跳出局部最优能力。
其它变异/交叉/选择与 DE 一致；统计反向学习触发次数；提供收敛曲线与触发点可视化。

五、差分进化（DifferentialEvolution 类）

输入：objective_fn、变量边界 bounds、NP、F、CR、max_iter。
变量维度 D = 8（如 bounds 所示）。
个体生成 generate_valid_individual：
在边界内随机生成并修复约束（保证 t_d2 - t_d1 ≥ 1、t_d3 - t_d2 ≥ 1、t_di + tau_i ≤ 63.75）。尝试多次随机修复，否则采用保守生成策略。
操作：mutation（rand/1）、crossover（二进制交叉确保至少一个维度来自变异），selection（评价后择优）。
optimize：
初始化种群并计算适应度；
主循环迭代 max_iter 代：对每个个体做变异、交叉、选择，更新种群；
记录 best_scores_history 与 mean_scores_history，用于绘制收敛曲线。
目标是最大化遮蔽时间（objective_fn 返回遮蔽总时长或 (duration, interval) 的元组）。
六、带反向学习的差分进化（DifferentialEvolutionWithOpposition）

在 DE 基础上加入两处反向学习（opposition-based learning）机制：
初始化时：为每个随机个体生成其“对立个体”（x_opposite = lb + ub - x），评估 2N 个个体，选择适应度最好的 N 个作为初始种群（提高初期多样性）。
进化中：每隔 opposition_interval 代，以 opposition_rate 的概率对当前种群生成对立种群并与当前种群合并，选取最优 N 个；计数 opposition_count。
其它演化操作（mutation, crossover, selection）与 DE 类似。
目的是提高收敛速度与逃逸局部最优的能力。
七、目标函数 objective_function_for_de

接口：x（8 维），FY（无人机位置），M（导弹位置列表）。
简单约束筛查：若时间间隔或起爆时间不满足即返回 0（不合法）。
计算 C0_list, t_e_list → uav_to_multimissile → 返回结果（代码中 uav_to_multimissile 返回 (total_duration, time_interval_list)）。
selection 等处兼容 objective 返回 tuple 或单值。
八、实验/运行脚本

run_de_optimization(): 使用 DifferentialEvolution（示例 NP=300, max_iter=100000），选择 M = 前两枚导弹、FY = uav_pos[4] 执行优化并打印结果、绘制收敛。
run_opposition_de_optimization(): 使用 DifferentialEvolutionWithOpposition（示例 NP=160, opposition_rate=0.5, opposition_interval=20）。
parameter_sensitivity_analysis(): 比较若干 DE 参数组合（NP,F,CR,max_iter）对效果影响并绘图。
batch_optimization_with_de(): 对所有 UAV×missile 组合做批量优化并保存 JSON 结果，绘制热力图/直方图/柱状比较。